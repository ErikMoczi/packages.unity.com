<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Unity Mobile Notifications: Unity Mobile Notifications Package</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Unity Mobile Notifications
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="d3/dda/namespace_unity.html">Unity</a> Mobile Notifications Package </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><b>Supported features:</b></p>
<ul>
<li>Schedule local repeatable or one-time notifications.</li>
<li>Cancel scheduled or already displayed notifications.</li>
<li>Android:<ul>
<li>Create and modify notification channels/categories on Android Oreo and above</li>
<li>Set custom notification icons.</li>
</ul>
</li>
<li>iOS:<ul>
<li>Use the Apple Push Notification Service (APNs) to send remote notifications.</li>
<li>Modify remote notification content if they are received while the app is running.</li>
<li>Group notification into threads (only supported on iOS 12+)</li>
</ul>
</li>
</ul>
<p><b>Requirements:</b></p>
<ul>
<li>Supports Android 4.1 (API 16)/iOS 10 and newer.</li>
<li>Compatible with <a class="el" href="d3/dda/namespace_unity.html">Unity</a> 2018.2 and newer.</li>
</ul>
<h2>Summary:</h2>
<p>The runtime API is split into two classes AndroidNotificationCenter and iOSNotificationCenter which respectively can be used to schedule and manage notifications for Android and iOS respectively. You can</p>
<p><b>Android:</b></p>
<ul>
<li><p class="startli"><b>Create a notification channel:</b></p>
<p class="startli">Every local notification must belong to a notification channel, notification channels are only supported by the system on Android Oreo (9.0) and above. On previous versions the channel behaviour is simulate, therefore settings such as priority (<code>Importance</code>) should be set on the channel.</p>
</li>
</ul>
<div class="fragment"><div class="line">var c = new AndroidNotificationChannel()</div><div class="line">{</div><div class="line">    Id = &quot;channel_id&quot;,</div><div class="line">    Name = &quot;Default Channel&quot;,</div><div class="line">    Importance = Importance.High,</div><div class="line">    Description = &quot;Generic notifications&quot;,</div><div class="line">}</div><div class="line">AndroidNotificationCenter.RegisterNotficationChannel(c);</div></div><!-- fragment --><ul>
<li><p class="startli"><b>Send a simple notification:</b></p>
<p class="startli">This example show how to schedule a simple notification with some text in it.</p>
</li>
</ul>
<div class="fragment"><div class="line">var notification = new AndroidNotification();</div><div class="line">notificationTitle = &quot;SomeTitle&quot;;</div><div class="line">notification.Text = &quot;SomeText&quot;;</div><div class="line">notification.FireTime = System.DateTime.Now.AddMinutes(5);</div><div class="line"></div><div class="line">//You should specify a custom icon for each notification otherwise a default Unity </div><div class="line">//icon will be shown in the status bar when instead. You can configure notification </div><div class="line">// icons in &quot;Edit -&gt; Project Settings -&gt; Mobile Notification Settings&quot;.</div><div class="line">notification.Icon = &quot;my_custom_icon_id&quot;;</div><div class="line"></div><div class="line">//Optionally you can also set a large icon which will be shown in notification view in // place of the small icon (which will be placed in a small badge atop the large icon)</div><div class="line">notification.LargeIcon = &quot;my_custom_large_icon_id&quot;</div><div class="line"></div><div class="line">// When scheduling each notification is assigned an unique identifier number</div><div class="line">// which can later be used to track notifications status or cancel it.</div><div class="line">var identifier = AndroidNotificationCenter.SendNotification(n, &quot;channel_id&quot;);</div><div class="line"></div><div class="line">//You can check if the notification was already delivered and perform an action</div><div class="line">//depending on the result. However notification status can only be tracked on Android //Marshmallow (6.0)  and anove.</div><div class="line">if ( CheckScheduledNotificationStatus(identifier) == NotificationStatus.Scheduled)</div><div class="line">{</div><div class="line">  // Replace the currently sheduled notification with a new notification.</div><div class="line">  UpdateScheduledNotifcation(identifier, newNotification);</div><div class="line">}</div><div class="line">else if ( CheckScheduledNotificationStatus(identifier) == NotificationStatus.Delivered)</div><div class="line">{</div><div class="line">  //Remove the notification from the status bar</div><div class="line">  CancelNotification(identifier)</div><div class="line">}</div><div class="line">else if ( CheckScheduledNotificationStatus(identifier) == NotificationStatus.Unknown)</div><div class="line">{</div><div class="line">    var identifier = AndroidNotificationCenter.SendNotification(n, &quot;channel_id&quot;);</div><div class="line">}</div></div><!-- fragment --><ul>
<li><p class="startli"><b>Handling received notifications when the app is running</b></p>
<p class="startli">You can subscribe to the <em>AndroidNotificationCenter.OnNotificationReceived</em> even to receive callbacks whenever a notification is delivered if the app is running.</p>
</li>
</ul>
<div class="fragment"><div class="line">AndroidNotificationCenter.OnNotificationReceived +=(int identifier, AndroidNotification notification, string channel)</div><div class="line">{</div><div class="line">  var msg = &quot;Notification received : &quot; + identifier + &quot;\n&quot;;</div><div class="line">  msg += &quot;\n Notification received: &quot;;</div><div class="line">  msg += &quot;\n .Title: &quot; + notification.Title;</div><div class="line">  msg += &quot;\n .Body: &quot; + notification.Text;</div><div class="line">  msg += &quot;\n .Channel: &quot; + channel.Name;</div><div class="line">  Debug.Log(msg);</div><div class="line">};</div></div><!-- fragment --><p><b>iOS:</b></p>
<ul>
<li><p class="startli"><b>Request authorization:</b></p>
<p class="startli">Request the system for permission to post local and receive remote notifications. After completion you can retrieve the <em>DeviceToken</em> if you created the request with <em>registerForRemoteNotifications</em> set to true and the app succesful registered on the APN. It can be ued to send push notifications to the device. See <a href="https://developer.apple.com/library/archive/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/HandlingRemoteNotifications.html#//apple_ref/doc/uid/TP40008194-CH6-SW1">Apple Developer Site</a> on how to add push notification support to your app.</p>
<p class="startli">The user migh only grants permission for certain notification features (in samle below we requested the permission to show UI Alert dialogs and show a badge on the app icon) in this case <em>RequestAuthorizationRequest.Granted</em> would still be <em>True</em> and you can check the actual authorization status by <em>iOSNotificationCenter.GetNotificationSettings</em>.</p>
<p class="startli">Alternatively you can enable <em>Request Authorization on App Launch</em> in <em>Edit -&gt; Project Settings -&gt; Mobile Notification Settings</em> then the app will automatically request for authorization when it's launched. Afterwards you might call this method again to determine the current authorization status but the UI system prompt will not be shown again if the user has already granted or denied authorization for this app. </p><div class="fragment"><div class="line">using (var req = new AuthorizationRequest(AuthorizationOption.AuthorizationOptionAlert | AuthorizationOption.AuthorizationOptionBadge, true))</div><div class="line">{</div><div class="line">  while (!req.IsFinished)</div><div class="line">  {</div><div class="line">      yield return null;</div><div class="line">  };</div><div class="line"></div><div class="line">  string res = &quot;\n RequestAuthorization: \n&quot;;</div><div class="line">  res += &quot;\n finished: &quot; + req.IsFinished;</div><div class="line">  res += &quot;\n granted :  &quot; + req.Granted;</div><div class="line">  res += &quot;\n error:  &quot; + req.Error;</div><div class="line">  res += &quot;\n deviceToken:  &quot; + req.DeviceToken;</div><div class="line">  Debug.Log(res);</div><div class="line">}</div></div><!-- fragment --></li>
<li><b>To Send a Simple and Cancel Notification in X seconds:</b> <div class="fragment"><div class="line">var timeTrigger = new iOSNotificationTimeIntervalTrigger()</div><div class="line">{</div><div class="line">  TimeInterval = new TimeSpan(0, minutes, seconds),</div><div class="line">  Repeats = false</div><div class="line">};</div><div class="line"></div><div class="line">var notification = new iOSNotification()</div><div class="line">{</div><div class="line">  // You can optional specify a custom Identifier which can later be </div><div class="line">  // used to cancel the notification, if you don&#39;t an unique string </div><div class="line">  // will be generated automtically.</div><div class="line">  //Identifier = &quot;_notification_01&quot; </div><div class="line">  Title = title,</div><div class="line">  Body = &quot;Scheduled at: &quot; + DateTime.Now.ToShortDateString() + &quot; triggered in 5 seconds&quot;,</div><div class="line">  Subtitle = &quot;This is a subtitle, something, something important...&quot;,</div><div class="line">  ShowInForeground = true,</div><div class="line">  ForegroundPresentationOption = foregoungOption,</div><div class="line">  CategoryIdentifier = &quot;category_a&quot;,</div><div class="line">  ThreadIdentifier = thread,</div><div class="line">  Trigger = timeTrigger,</div><div class="line">};</div><div class="line"></div><div class="line">iOSNotificationCenter.ScheduleNotification(notification);</div><div class="line"></div><div class="line">// You can cancel the notification if wasn&#39;t yet triggered:</div><div class="line">iOSNotificationCenter.RemoveScheduledNotification(notification.Identifier);</div><div class="line"></div><div class="line">//If the notification was already displayed to the user, you can remove it from the </div><div class="line">//Notification Center:</div><div class="line">iOSNotificationCenter.RemoveDeliveredNotification(notification.Identifier)</div></div><!-- fragment --></li>
<li><p class="startli"><b>Other triggers:</b></p>
<p class="startli">Besides the time interval trigger you can also use calendar and location trigger:</p>
</li>
</ul>
<div class="fragment"><div class="line">//All the fields in iOSNotificationCalendarTrigger are optional but you need to set </div><div class="line">//atleast one for it work. For example if you only set the hour and minute fields the  //system will automitcally trigger the notification on the next specified hour and minite.</div><div class="line">var calendarTrigger = new iOSNotificationCalendarTrigger()</div><div class="line">{</div><div class="line">  // Year = 2018,</div><div class="line">  // Month = 8,</div><div class="line">  //Day = 30,</div><div class="line">  Hour = 12,</div><div class="line">  Minute = 0,</div><div class="line">  // Second = 0</div><div class="line">  Repeats = false</div><div class="line">};</div><div class="line"></div><div class="line">// You can also create location trigger when you want to schedule the delivery of a </div><div class="line">// notification when the device enters or leaves a specific geographic region.</div><div class="line">// Before scheduling any notifications using this trigger,</div><div class="line">// your app must have authorization to use Core Location and must have when-in-use </div><div class="line">// permissions. Use the Unity LocationService API to request for this authorization.</div><div class="line">// See https://developer.apple.com/documentation/corelocation/clregion?language=objc for // additional information.</div><div class="line">var locationTrigger = iOSNotificationLocationTrigger()</div><div class="line">{</div><div class="line">  // The center coordinate is defined using the WGS 84 system.</div><div class="line">  // In this case the notification would be triggered if the user</div><div class="line">  // entered an area within a 250 meter radius around Eiffel Tower in Paris.</div><div class="line">  Vector2 Center = new Vector2(2.294498, 48.858263),</div><div class="line">  Radius = 250,</div><div class="line">  NotifyOnEntry = true,</div><div class="line">  NotifyOnExit = false,</div><div class="line">}</div></div><!-- fragment --><ul>
<li><p class="startli">**Handling received notifications when the app is running **</p>
<p class="startli">You might want to perform a custom action instead of just showing a notification alert if it's triggered while the app is running:</p>
</li>
</ul>
<div class="fragment"><div class="line">// By default if a local notification is triggered while the app that scheduled it is</div><div class="line">// in the foreground an alert will not be shown for that notification.</div><div class="line">// If you wish the notification to behave the same way as if the the app was not running</div><div class="line">// you need to enable this `ShowInForeground` when scheduling the notification:&quot;</div><div class="line"></div><div class="line">notification.ShowInForeground = True</div><div class="line"></div><div class="line">// In this case you will also need to specify it&#39;s &#39;ForegroundPresentationOption&#39;</div><div class="line">notification.ForegroundPresentationOption = (PresentationOption.NotificationPresentationOptionSound | PresentationOption.NotificationPresentationOptionAlert)</div><div class="line"></div><div class="line">// Alternatively you might wish to perform some other action, like displaying the </div><div class="line">// notification content using the in-game UI, when the notification is triggered.</div><div class="line">// In this case you need to subscribe to the `OnNotificationReceived` which will be </div><div class="line">// called whenever a local or a remote notification is received (irregardless if it&#39;s shown in the foregound).</div><div class="line"></div><div class="line">iOSNotificationCenter.OnNotificationReceived += notification =&gt;</div><div class="line">{</div><div class="line">  var msg = &quot;Notification received : &quot; + notification.Identifier + &quot;\n&quot;;</div><div class="line">  msg += &quot;\n Notification received: &quot;;</div><div class="line">  msg += &quot;\n .Title: &quot; + notification.Title;</div><div class="line">  msg += &quot;\n .Badge: &quot; + notification.Badge;</div><div class="line">  msg += &quot;\n .Body: &quot; + notification.Body;</div><div class="line">  msg += &quot;\n .CategoryIdentifier: &quot; + notification.CategoryIdentifier;</div><div class="line">  msg += &quot;\n .Subtitle: &quot; + notification.Subtitle;</div><div class="line">  Debug.Log(msg);</div><div class="line">};</div><div class="line"></div><div class="line">// When receiving remote notification while the app is running you might wish modify the // remote notification content or not show it at all. You can do this by subscribing </div><div class="line">// to the `OnRemoteNotificationReceived` event. Please note that if you do this remote</div><div class="line">// notifications will never be displayed when the app is running. If you still wish to </div><div class="line">// show an alert for it you&#39;ll have to schedule a local notification using the remote </div><div class="line">// notifications content:</div><div class="line"></div><div class="line">iOSNotificationCenter.OnRemoteNotificationReceived += notification =&gt;</div><div class="line">{</div><div class="line">  // When a remote notification is received modify it&#39;s contents and show it</div><div class="line">    // after 1 second.</div><div class="line">  var timeTrigger = new iOSNotificationTimeIntervalTrigger()</div><div class="line">  {</div><div class="line">      TimeInterval = new TimeSpan(0, 0, 1),</div><div class="line">      Repeats = false</div><div class="line">  };</div><div class="line"></div><div class="line">  iOSNotification  n = new iOSNotification()</div><div class="line">  {</div><div class="line">      Title = &quot;Remote : &quot; + notification.Title,</div><div class="line">      Body =  &quot;Remote : &quot; + notification.Body,</div><div class="line">      Subtitle =  &quot;RERemote: &quot; + notification.Subtitle,</div><div class="line">      ShowInForeground = true,</div><div class="line">      ForegroundPresentationOption = PresentationOption.NotificationPresentationOptionSound | PresentationOption.NotificationPresentationOptionAlert | PresentationOption.NotificationPresentationOptionBadge,</div><div class="line">      CategoryIdentifier = notification.CategoryIdentifier,</div><div class="line">      ThreadIdentifier = notification.ThreadIdentifier,</div><div class="line">      Trigger = timeTrigger,</div><div class="line">  };</div><div class="line">  iOSNotificationCenter.ScheduleNotification(n);</div><div class="line"></div><div class="line">  Debug.Log(&quot;Rescheduled remote notifications with id: &quot; + notification.Identifier);</div><div class="line"></div><div class="line">};</div></div><!-- fragment --><h2>FAQ</h2>
<p><b>Notifications with a location trigger do not work.</b></p>
<p>Make sure the CoreLocation framework is added to your project. You can do this in the <code>Mobile Notification Settings</code> menu in the <a class="el" href="d3/dda/namespace_unity.html">Unity</a> Editor. Or by adding it manually to the Xcode project (or using the <a class="el" href="d3/dda/namespace_unity.html">Unity</a> Xcode API). </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
